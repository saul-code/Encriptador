<!DOCTYPE html>
<html lan="es">
    <link rel="stylesheet" href="style.css">

    <title>Encriptador</title>

    <head></head>

    <body>
        <div class="encabezado">
            <img id="logo" src="fotos/logo.svg.png">
        </div>

        <div class="myForm">
            <form >
                <input id="form" type="text" placeholder="Ingrese el texto aqui"><br/>
            </form>
        </div>

        <div class="botones">
            <div class="header">
                <img id="alerta" src="fotos/Vector!.svg">
                <p>Solo letras min√∫sculas y sin acentos</p>
            </div>
            <button id="encode" onclick="desaparece()" >Encriptar</button>
            <button id="decode"  >Desencriptar</button>
        </div>

        <div class="box">
            <img id="foto" src="fotos/foto.svg">
            <div class="mensaje">
                <algin><h3>Ningun mensaje fue encontrado</h3></algin>
                <p>ingrese el texto que desees encriptar o desencriptar</p>
            </div>
        </div>
    </body>
 
    <script>
        const llave = [[1,0,0],[2,1,0],[1,1,1]];
        var mB = [[6],[14],[14]];
        var entrada;
        let btnEncode =document.getElementById('encode');
        let btnDecode = document.getElementById('decode');
        btnDecode.onclick = decodificar;

        //Se le pasa a al variable btnEncode la funcion para codificar el mensaje
        btnEncode.onclick= function(){
            //Desaparece la imagen en el box
            desaparece();
            //entrada del input
            entrada =document.getElementById('form').value;
            //junta la entrada y lo transforma en un arreglo
            let entradaArray= entrada.split('');

            let entradaVecotres = vectoresMensaje(entradaArray);
            codifica(entradaVecotres);
        }

        /**
         * Separa el arreglo de entrada en una matriz de nx3 con n la longitud del arreglo 
         * entre 3 y si no es divisible entre 3 se agrega celdas vacias para que sea divisble
         * @params entrada
         * @return arreglo de numeros. 
         **/
        function vectoresMensaje(entrada){
            let vectores = [];
            if(entrada.length%3 == 0 ){
                var numVec = entrada.length/3;
                for(var a =0,m=0;m<numVec;m++,a+=3){
                    vectores[m]=[];
                    vectores[m].push(entrada[a].charCodeAt(0));
                    vectores[m].push(entrada[a+1].charCodeAt(0));
                    vectores[m].push(entrada[a+2].charCodeAt(0));
                }
            }else{
                var numVec = Math.floor(entrada.length/3);
                for(var a =0,m=0;m<numVec;m++,a+=3){
                    vectores[m]=[];
                    vectores[m].push(entrada[a].charCodeAt(0));
                    vectores[m].push(entrada[a+1].charCodeAt(0));
                    vectores[m].push(entrada[a+2].charCodeAt(0));
                }
                var residuo = entrada.length%3;
                if ( residuo == 2){
                    vectores[numVec] = [];
                    vectores[numVec].push(entrada[(numVec*3)].charCodeAt(0))
                    vectores[numVec].push(entrada[(numVec*3)+1].charCodeAt(0))
                    vectores[numVec].push(' '.charCodeAt(0));
                }else {
                    vectores[numVec] = [];
                    vectores[numVec].push(entrada[(numVec*3)].charCodeAt(0))
                    vectores[numVec].push(' '.charCodeAt(0));
                    vectores[numVec].push(' '.charCodeAt(0));
                }
            }
            return vectores;

        }

        function codifica(mensajevectores){
            let salidaVectores = [];
            for(var i =0,a=0; i<mensajevectores.length; a+=3,i++){
                let vectorColumna = [[],[],[]];
                vectorColumna[0][0] =mensajevectores[i][0];
                vectorColumna[1][0] =mensajevectores[i][1];
                vectorColumna[2][0] =mensajevectores[i][2];

                let vectorColumna2 = multiply(llave,vectorColumna);
                salidaVectores[a] =  vectorColumna2[0][0];
                salidaVectores[a+1] = vectorColumna2[1][0];
                salidaVectores[a+2] = vectorColumna2[2][0];
            }
            console.log(salidaVectores);
            return salidaVectores;
        }

        //Funcion decodificar
       
        function decodificar(){
                console.log(entrada);
        }

        //Desaparecer
        function desaparece(){
            let x=document.getElementById('foto');
            x.style.display = 'none';
        }

        function multiply(a, b) {
            var aNumRows = a.length, aNumCols = a[0].length,bNumRows = b.length, bNumCols = b[0].length,
            m = new Array(aNumRows);  // initialize array of rows
            for (var r = 0; r < aNumRows; ++r) {
                m[r] = new Array(bNumCols); // initialize the current row
                for (var c = 0; c < bNumCols; ++c) {
                    m[r][c] = 0;             // initialize the current cell
                    for (var i = 0; i < aNumCols; ++i) {
                        m[r][c] += a[r][i] * b[i][c];
                    }
                }
            }
            return m;
        }

        function display(m) {
            for (var r = 0; r < m.length; ++r) {
                document.write('&nbsp;&nbsp;'+m[r].join(' ')+'<br />');
            }
        }

    document.write("<br/>");
    document.write('matrix a:<br />'); 
    display(llave);
    document.write('matrix b:<br />');
    display(mB);
    document.write('a * b =<br />');
    display(multiply(llave, mB)); 

    </script>

</html> 